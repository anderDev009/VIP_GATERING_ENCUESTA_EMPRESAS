@model VIP_GATERING.WebUI.Models.SemanaEmpleadoVM
@{
    ViewData["Title"] = "Semana del empleado";
}
@section Breadcrumb{<div class="text-sm text-slate-500 mb-4">Inicio / Empleados / Semana</div>}

<div class="mb-4">
    <h1 class="text-2xl font-semibold">Semana del empleado</h1>
    <div class="text-sm text-slate-600">@Model.EmpresaNombre - @Model.SucursalNombre</div>
    <div class="text-sm text-slate-600">@Model.FechaInicio.ToString("dd/MM/yyyy") - @Model.FechaTermino.ToString("dd/MM/yyyy") (@Model.OrigenMenu)</div>
    @if (Model.Bloqueado)
    {
        <div class="mt-2 text-amber-700">@(string.IsNullOrWhiteSpace(Model.MensajeBloqueo) ? $"Encuesta completada (@Model.RespuestasCount/@Model.TotalDias)." : Model.MensajeBloqueo)</div>
    }
    else
    {
        <div class="mt-2 text-slate-600">Encuesta en progreso (@Model.RespuestasCount/@Model.TotalDias).</div>
    }
    @if (User.IsInRole("Admin") || User.IsInRole("Sucursal"))
    {
        <form asp-controller="Encuestas" asp-action="Anular" method="post" class="mt-3">
            @Html.AntiForgeryToken()
            <input type="hidden" name="empleadoId" value="@Model.EmpleadoId" />
            <button class="btn-primary" onclick="return confirm('�Anular encuesta del empleado?');">Anular encuesta</button>
        </form>
    }
    @if (Model.EsJefe && User.IsInRole("Admin"))
    {
        <div class="mt-3">
            <a asp-action="EditarSemana" asp-route-id="@Model.EmpleadoId" class="btn-outline">Editar selecciones (jefe)</a>
        </div>
    }
</div>

<div class="grid md:grid-cols-2 gap-4">
@foreach (var d in Model.Dias)
{
    <div class="card">
        <div class="font-medium mb-2">@d.DiaSemana</div>
        @{
            var opcionesDia = new[]
            {
                new { Clave = "A", Nombre = d.A, Imagen = d.ImagenA },
                new { Clave = "B", Nombre = d.B, Imagen = d.ImagenB },
                new { Clave = "C", Nombre = d.C, Imagen = d.ImagenC }
            };
        }
        <div class="space-y-2">
            @foreach (var opc in opcionesDia)
            {
                <div class="flex items-center gap-3 border rounded-lg p-3">
                    @if (!string.IsNullOrWhiteSpace(opc.Imagen))
                    {
                        <img src="@opc.Imagen" alt="Opci&oacute;n @opc.Clave" class="w-16 h-16 object-cover rounded-md border" />
                    }
                    <div>
                        <div class="text-xs uppercase text-slate-500">Opci&oacute;n @opc.Clave</div>
                        <div class="font-medium">@(!string.IsNullOrWhiteSpace(opc.Nombre) ? opc.Nombre : "Sin definir")</div>
                    </div>
                </div>
            }
        </div>
        <div class="mt-2 text-slate-700">Selecci&oacute;n: <strong>@(d.Seleccion == null ? "�" : d.Seleccion.ToString())</strong></div>
    </div>
}
</div>

<div class="mt-6">
    <a asp-action="Index" class="btn-outline">Volver a empleados</a>
</div>
