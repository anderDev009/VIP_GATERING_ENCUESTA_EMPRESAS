@{
    ViewData["Title"] = "Panel principal";
    var nombre = User.Identity?.IsAuthenticated == true ? User.Identity.Name : "Invitado";
    var esAdmin = User.IsInRole("Admin");
    var hoy = DateTime.Today;
    var diff = ((int)hoy.DayOfWeek - (int)DayOfWeek.Monday + 7) % 7;
    var lunes = hoy.AddDays(-diff);
    var viernes = lunes.AddDays(4);
}

<section class="dashboard-hero">
    <div>
        <p class="text-sm text-slate-500">Bienvenido de nuevo</p>
        <h1>@nombre</h1>
        <p class="text-slate-500 max-w-xl">Consulta el estado general de menus y accede rapidamente a los modulos clave para continuar con la operacion diaria.</p>
        <div class="mt-4 flex flex-wrap gap-3">
            <a asp-controller="Empleado" asp-action="MiSemana" class="btn-primary">Mi semana</a>
            @if (esAdmin)
            {
                <a asp-controller="Menu" asp-action="Administrar" class="btn-outline">Administrar menus</a>
            }
        </div>
    </div>
    <div class="dashboard-metric">
        <p class="label">Semana actual</p>
        <p class="value">@($"{lunes:dd MMM} - {viernes:dd MMM}")</p>
        <p class="text-xs text-slate-400">@lunes.ToString("dd MMM yyyy") - @viernes.ToString("dd MMM yyyy")</p>
    </div>
</section>

<section class="dashboard-grid">
    <div class="dashboard-card">
        <span class="text-xs uppercase text-slate-400">Operacion</span>
        <a asp-controller="Empleado" asp-action="MiSemana">Mi semana</a>
        <p>Confirma selecciones y visualiza el menu asignado para cada empleado.</p>
    </div>
    @if (esAdmin)
    {
        <div class="dashboard-card">
            <span class="text-xs uppercase text-slate-400">Recursos</span>
            <a asp-controller="Empleados" asp-action="Index">Empleados</a>
            <p>Gestiona usuarios, acceso a menus y creacion de cuentas.</p>
        </div>
        <div class="dashboard-card">
            <span class="text-xs uppercase text-slate-400">Logistica</span>
            <a asp-controller="Sucursales" asp-action="Index">Filiales</a>
            <p>Actualiza la informacion de Filiales, horarios y reglas de subsidio por Empresa.</p>
        </div>
        @if (esAdmin)
        {
            <div class="dashboard-card">
                <span class="text-xs uppercase text-slate-400">Analisis</span>
                <a asp-controller="Reportes" asp-action="Distribucion">Distribucion</a>
                <p>Resumen por filial y detalle por empleado para preparar la entrega.</p>
            </div>
        }
    }
    else
    {
        <div class="dashboard-card">
            <span class="text-xs uppercase text-slate-400">Soporte</span>
            <a asp-controller="Account" asp-action="ChangePassword">Actualizar contrasena</a>
            <p>Refuerza la seguridad de tu cuenta en segundos.</p>
        </div>
    }
</section>

